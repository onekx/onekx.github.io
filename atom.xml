<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kx&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://onekx.github.io/"/>
  <updated>2020-04-04T09:51:20.529Z</updated>
  <id>http://onekx.github.io/</id>
  
  <author>
    <name>Kx&#39;s Blog</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ESLint 的配置</title>
    <link href="http://onekx.github.io/post/deploy-eslint/"/>
    <id>http://onekx.github.io/post/deploy-eslint/</id>
    <published>2020-04-04T07:37:39.000Z</published>
    <updated>2020-04-04T09:51:20.529Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h4 id="1-安装所需要的包">1. 安装所需要的包<a class="post-anchor" href="#1-安装所需要的包"></a></h4>   <figure class="highlight shell"><table><tbody><tr><td class="code"><pre><code class="hljs shell">npm install --save-dev husky lint-staged eslint<br></code></pre></td></tr></tbody></table></figure><h4 id="2-如果配置文件里有使用到airbnb，通过以下命令来安装eslint-config-airbnb及它的相关依赖">2. 如果配置文件里有使用到airbnb，通过以下命令来安装eslint-config-airbnb及它的相关依赖<a class="post-anchor" href="#2-如果配置文件里有使用到airbnb，通过以下命令来安装eslint-config-airbnb及它的相关依赖"></a></h4>   <figure class="highlight shell"><table><tbody><tr><td class="code"><pre><code class="hljs shell">npm install --save-dev eslint-config-airbnb  <br>npm install --save eslint-plugin-import eslint-plugin-react eslint-plugin-jsx-a11y<br></code></pre></td></tr></tbody></table></figure><h4 id="3-设置一个配置文件">3. 设置一个配置文件<a class="post-anchor" href="#3-设置一个配置文件"></a></h4>   <figure class="highlight shell"><table><tbody><tr><td class="code"><pre><code class="hljs shell">./node_modules/.bin/eslint --init<br></code></pre></td></tr></tbody></table></figure><h4 id="4-在根目录下-eslintrc-文件中配置自己的rules，以下是我使用的配置：">4. 在根目录下 .eslintrc 文件中配置自己的rules，以下是我使用的配置：<a class="post-anchor" href="#4-在根目录下-eslintrc-文件中配置自己的rules，以下是我使用的配置："></a></h4>   <figure class="highlight json"><table><tbody><tr><td class="code"><pre><code class="hljs json">{  <br> <span class="hljs-attr">"env"</span>: {  <br>     <span class="hljs-attr">"browser"</span>: <span class="hljs-literal">true</span>,  <br>     <span class="hljs-attr">"es6"</span>: <span class="hljs-literal">true</span>,  <br>     <span class="hljs-attr">"node"</span>: <span class="hljs-literal">true</span>  <br> },  <br> <span class="hljs-attr">"extends"</span>: [  <br>     <span class="hljs-string">"airbnb"</span>  <br> ],  <br> <span class="hljs-attr">"parser"</span>: <span class="hljs-string">"babel-eslint"</span>,  <br> <span class="hljs-attr">"globals"</span>: {  <br>     <span class="hljs-attr">"Atomics"</span>: <span class="hljs-string">"readonly"</span>,  <br>     <span class="hljs-attr">"SharedArrayBuffer"</span>: <span class="hljs-string">"readonly"</span>  <br> },  <br> <span class="hljs-attr">"parserOptions"</span>: {  <br>     <span class="hljs-attr">"ecmaFeatures"</span>: {  <br>         <span class="hljs-attr">"jsx"</span>: <span class="hljs-literal">true</span>,  <br>         <span class="hljs-attr">"legacyDecorators"</span>: <span class="hljs-literal">true</span>  <br>     },  <br>     <span class="hljs-attr">"ecmaVersion"</span>: <span class="hljs-number">2018</span>,  <br>     <span class="hljs-attr">"sourceType"</span>: <span class="hljs-string">"module"</span>  <br> },  <br> <span class="hljs-attr">"plugins"</span>: [  <br>     <span class="hljs-string">"react"</span>  <br> ],  <br> <span class="hljs-attr">"rules"</span>: {  <br>     <span class="hljs-attr">"indent"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-number">4</span>, { <span class="hljs-attr">"SwitchCase"</span>: <span class="hljs-number">1</span>,<span class="hljs-attr">"flatTernaryExpressions"</span>: <span class="hljs-literal">true</span> }],  <br>     <span class="hljs-attr">"max-len"</span>: [<span class="hljs-string">"error"</span>, { <span class="hljs-attr">"code"</span>: <span class="hljs-number">120</span>, <span class="hljs-attr">"ignoreUrls"</span>: <span class="hljs-literal">true</span> }],  <br>     <span class="hljs-attr">"react/jsx-indent"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-number">4</span>],  <br>     <span class="hljs-attr">"react/jsx-indent-props"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-number">4</span>],  <br>     <span class="hljs-attr">"react/jsx-filename-extension"</span>: [<span class="hljs-string">"warn"</span>, { <span class="hljs-attr">"extensions"</span>: [<span class="hljs-string">".js"</span>,<span class="hljs-string">".jsx"</span>] }],  <br>     <span class="hljs-attr">"react/prop-types"</span>: <span class="hljs-string">"off"</span>,  <br>     <span class="hljs-attr">"no-unused-expressions"</span>: [<span class="hljs-string">"error"</span>, { <span class="hljs-attr">"allowShortCircuit"</span>: <span class="hljs-literal">true</span> }],  <br>     <span class="hljs-attr">"no-underscore-dangle"</span>: <span class="hljs-number">0</span>,  <br>     <span class="hljs-attr">"no-console"</span>: [<span class="hljs-string">"error"</span>, { <span class="hljs-attr">"allow"</span>: [<span class="hljs-string">"log"</span>] }],  <br>     <span class="hljs-attr">"react/jsx-props-no-spreading"</span>: [<span class="hljs-string">"error"</span>, { <span class="hljs-attr">"custom"</span>: <span class="hljs-string">"ignore"</span> }],  <br>     <span class="hljs-attr">"import/no-cycle"</span>: <span class="hljs-number">0</span>,  <br>     <span class="hljs-attr">"radix"</span>: [<span class="hljs-string">"error"</span>, <span class="hljs-string">"as-needed"</span>]  <br> }  <br> }<br></code></pre></td></tr></tbody></table></figure><h4 id="5-在-package-json-文件中配置husky和lint-staged，用于提交前的检测，示例：">5. 在 package.json 文件中配置husky和lint-staged，用于提交前的检测，示例：<a class="post-anchor" href="#5-在-package-json-文件中配置husky和lint-staged，用于提交前的检测，示例："></a></h4>   <figure class="highlight"><table><tbody><tr><td class="code"><pre><code class="hljs json">"husky": {  <br>    "hooks": {    <br>        "pre-commit": "lint-staged"  <br>     }<br> },<br> "lint-staged": {  <br>     "*.js": [    <br>         "eslint --fix",    <br>         <span class="hljs-string">"git add"</span>  <br>     ]<br> }<br></code></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h4 id=&quot;1-安装所需要的包&quot;&gt;1. 安装所需要的包&lt;a class=&quot;post-anchor&quot; href=&quot;#1-安装所需要的包&quot;&gt;&lt;/a&gt;&lt;/h4&gt;   &lt;figure class=&quot;highlight shell&quot;&gt;&lt;
      
    
    </summary>
    
    
    
      <category term="ESLint" scheme="http://onekx.github.io/tags/ESLint/"/>
    
  </entry>
  
  <entry>
    <title>对 Promise 的理解</title>
    <link href="http://onekx.github.io/post/about_promise/"/>
    <id>http://onekx.github.io/post/about_promise/</id>
    <published>2020-04-02T10:47:31.000Z</published>
    <updated>2020-04-04T07:25:01.202Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><a href="../../../images/Promise.png" data-caption data-fancybox="images"><img src="../../../images/Promise.png" alt></a><hr><p><strong>以下是自己对Promise的简单理解</strong></p><h3 id="Promise的作用：">Promise的作用：<a class="post-anchor" href="#Promise的作用："></a></h3><p>js中使用回调函数进行事件处理，如果嵌套多层回调函数，将会陷入 回调地狱，使代码难以理解以及维护，例如：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><code class="hljs javascript">method1(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, result</span>) </span>{<br>    <span class="hljs-keyword">if</span> (err) {<br>        <span class="hljs-keyword">throw</span> err;<br>    } <br>    method2(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, result</span>) </span>{<br>        <span class="hljs-keyword">if</span> (err) {<br>            <span class="hljs-keyword">throw</span> err;<br>        } <br>        method3(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, result</span>) </span>{<br>            <span class="hljs-keyword">if</span> (err) {<br>                <span class="hljs-keyword">throw</span> err;<br>            } <br>            method4(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, result</span>) </span>{<br>                <span class="hljs-keyword">if</span> (err) {<br>                    <span class="hljs-keyword">throw</span> err;<br>                } <br>                method5(result);<br>            });<br>        });<br>    });<br>});<br></code></pre></td></tr></tbody></table></figure><p><strong>Promise就是解决以上这种问题的异步编程方案。</strong></p><hr><h3 id="Promise的构造：">Promise的构造：<a class="post-anchor" href="#Promise的构造："></a></h3><p>直接在控制台中将Promise打印出来:</p><a href="../../../images/Promise的结构.png" data-caption data-fancybox="images"><img src="../../../images/Promise的结构.png" alt></a><p>可以看到 Promise 包含了 resolve, reject, all, race等方法，原型上有 then, catch, finally等方法，所以当 new 一个 Promise 对象时一定包含以上方法。</p><hr><h3 id="Promise的三种状态：">Promise的三种状态：<a class="post-anchor" href="#Promise的三种状态："></a></h3><blockquote><p>Pending（进行中），Fulfilled（已完成），Rejected（已拒绝）</p></blockquote><p>当 Promise 被声明时，即处于 <strong>“Pending”</strong> 状态。<br>接着状态的变更只能是 <strong>“Pending => Fufilled”</strong> （Fufilled对应的就是resolv方法）和 <strong>“Pending => Rejected”</strong>两种，<strong>且状态的变更是单向不可逆的</strong>。</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {});<br><span class="hljs-comment">// Pending状态</span><br><span class="hljs-keyword">var</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> resolve());<br><span class="hljs-comment">// Fulfilled状态</span><br><span class="hljs-keyword">var</span> promise3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> reject());<br><span class="hljs-comment">// Rejected状态</span><br></code></pre></td></tr></tbody></table></figure><hr><h3 id="then-、-catch-和-finally-的用法：">then 、 catch 和 finally 的用法：<a class="post-anchor" href="#then-、-catch-和-finally-的用法："></a></h3><h4 id="then：">then：<a class="post-anchor" href="#then："></a></h4><p>then 为返回成功时调用的方法。<br>then 有两个参数，第一个参数是 resolved 状态的回调函数，第二个参数 <strong>(可选)</strong> 是 rejected 状态的回调函数。</p><blockquote><p>建议 then 中只接受第一个参数，第二个参数放到 catch 中解决</p></blockquote><h4 id="catch：">catch：<a class="post-anchor" href="#catch："></a></h4><p>catch是失败时调用的方法。catch只接受一个参数，即当发生错误时的回调函数。<br><strong>.catch()</strong>  等同于 <strong>.then(null, rejection)</strong> 或 <strong>.then(undefined, rejection)</strong></p><h4 id="finally：">finally：<a class="post-anchor" href="#finally："></a></h4><p>finally方法不管 Promise 对象最后状态如何，在执行完 then 和 catch 指定的回调函数以后，最后都会执行 finally 方法指定的回调函数。</p><p>例：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> flag = <span class="hljs-literal">true</span>;<br><br><span class="hljs-keyword">var</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {<br>    <span class="hljs-keyword">if</span>(flag) {<br>        resolve(<span class="hljs-literal">true</span>);<br>    } <span class="hljs-keyword">else</span> {<br>        reject(<span class="hljs-literal">false</span>);<br>    }<br>});<br><br>promise.then(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'成功'</span>);<br>}).catch(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'失败'</span>);<br>}).finally(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'结束'</span>);<br>});<br><br><span class="hljs-comment">// flag = true, 成功 结束。</span><br><span class="hljs-comment">// flag = false 失败 结束。</span><br><span class="hljs-comment">// 都会打印出 “结束”</span><br></code></pre></td></tr></tbody></table></figure><hr><h3 id="all-和-race-方法：">all 和 race 方法：<a class="post-anchor" href="#all-和-race-方法："></a></h3><h4 id="all的用法：">all的用法：<a class="post-anchor" href="#all的用法："></a></h4><p>.all() 接受一个 Promise 的实例数组，只有当所有全部 Promise 执行 resolve 或者有一个 reject 后才执行下面的回调函数。</p><ol><li>当所有 Promise 都为 resolve 时：</li></ol><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =></span> {<br>    resolve(<span class="hljs-number">1</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =></span> {<br>    resolve(<span class="hljs-number">2</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =></span> {<br>    resolve(<span class="hljs-number">3</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise4 = <span class="hljs-built_in">Promise</span>.all([promise1,promise2,promise3]);<br>promise4.then(<span class="hljs-function"><span class="hljs-params">value</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(value);<br>})<br><br><span class="hljs-comment">// [1,2,3]</span><br></code></pre></td></tr></tbody></table></figure><ol start="2"><li>若某个 Promise 被拒绝了，那么会立即结束，不会等待其他 Promise 的结束：</li></ol><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =></span> {<br>    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>        reject(<span class="hljs-number">1</span>);<br>    },<span class="hljs-number">1000</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =></span> {<br>    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>        resolve(<span class="hljs-number">2</span>);<br>    },<span class="hljs-number">2000</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =></span> {<br>    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>        resolve(<span class="hljs-number">3</span>);<br>    },<span class="hljs-number">3000</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise4 = <span class="hljs-built_in">Promise</span>.all([promise1,promise2,promise3]);<br>promise4.then(<span class="hljs-function"><span class="hljs-params">value</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(value);<br>}).catch(<span class="hljs-function"><span class="hljs-params">value</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(value);<br>})<br>    <br><span class="hljs-comment">// 1</span><br><span class="hljs-comment">// 因为 promise1 为 reject，所以 .all() 会立即结束，不会等待 promise2 和 promise3</span><br></code></pre></td></tr></tbody></table></figure><h4 id="race-的用法：">race 的用法：<a class="post-anchor" href="#race-的用法："></a></h4><p>race 与 all 一样可以接受一个由 Promise 组成的数组作为参数，但是 race 不会等待所有 Promise 执行完成，只要数组中有一个 Promise 状态发生改变，race 方法就会立即执行回调函数，状态由最先结束的 Promise 决定。</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =></span> {<br>    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>        reject(<span class="hljs-number">1</span>);<br>    },<span class="hljs-number">4000</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =></span> {<br>    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>        resolve(<span class="hljs-number">2</span>);<br>    },<span class="hljs-number">2000</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =></span> {<br>    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {<br>        resolve(<span class="hljs-number">3</span>);<br>    },<span class="hljs-number">3000</span>);<br>});<br><br><span class="hljs-keyword">let</span> promise4 = <span class="hljs-built_in">Promise</span>.race([promise1,promise2,promise3]);<br>promise4.then(<span class="hljs-function"><span class="hljs-params">value</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(value);<br>}).catch(<span class="hljs-function"><span class="hljs-params">value</span> =></span> {<br>    <span class="hljs-built_in">console</span>.log(value);<br>})<br><br><span class="hljs-comment">// 2</span><br><span class="hljs-comment">// promise2 延时两秒最先完成，然后立即结束，状态为resolve</span><br></code></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;a href=&quot;../../../images/Promise.png&quot; data-caption data-fancybox=&quot;images&quot;&gt;&lt;img src=&quot;../../../images/Promise.png&quot; al
      
    
    </summary>
    
    
    
      <category term="ES6" scheme="http://onekx.github.io/tags/ES6/"/>
    
      <category term="JavaScript" scheme="http://onekx.github.io/tags/JavaScript/"/>
    
  </entry>
  
</feed>
